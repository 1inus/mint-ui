var TOOLS={undo:{title:"向后撤销一步",fn:function(){document.execCommand("undo",!1,null),saveScene()}},redo:{title:"向前撤销一步",fn:function(){document.execCommand("redo",!1,null),saveScene()}},removeFormat:{title:"清除格式"},bold:{title:"粗体"},italic:{title:"斜体"},underline:{title:"下划线"},strikeThrough:{title:"删除线"},justifyLeft:{title:"靠左对齐"},justifyCenter:{title:"居中对齐"},justifyRight:{title:"靠右对齐"},justifyFull:{title:"两端对齐"},indent:{title:"增加缩进"},outdent:{title:"减少缩进"},superscript:{title:"上标"},subscript:{title:"下标"},insertUnorderedList:{title:"无序列表"},insertOrderedList:{title:"有序列表"},quote:{title:"引用",fn:function(){var l=TXT?TXT:"<br/>";insertHtml('<blockquote class="quote">'+l+"</blockquote>")}},lang:{title:"添加代码",init:function(l){var o=$('<ul class="drop_down_box" tabindex=-1><li>html</li><li>javascript</li><li>java</li><li>phyon</li><li>ruby</li><li>shell</li><li>sql</li><li>php</li></ul>');l.append(o),o.delegate("li","click",function(){var l=$(this).html();insertHtml('<pre class="'+l+'" title="'+l+'代码"><br/></pre>'),o.blur()})},fn:function(l,o){o.children("ul").slideDown("fast").focus()}},cancelQuote:{title:"取消引用",fn:function(){excu("outdent",!1,null)}},head:{title:"标题样式",init:function(l){var o='<span class="tool" unselectable="on">正文与标题</span><ul class="drop_down_box font_size_values" tabIndex="-1" onclick="$(this).blur();"><li op="fb-p">正文</li><li op="fb-h1"><h1>h1</h1></li><li op="fb-h2"><h2>h2</h2></li><li op="fb-h3"><h3>h3</h3></li><li op="fb-h4"><h4>h4</h4></li><li op="fb-h5"><h5>h5</h5></li><li op="fb-h6"><h6>h6</h6></li></ul>';l.html(o)},fn:function(l,o){o.children("ul").slideDown("fast").focus()}},fontSize:{title:"字号",init:function(l){var o='<span class="tool" unselectable="on">字号</span><ul class="drop_down_box h_values" tabIndex="-1" onclick="$(this).blur();"><li op="FontSize" style="font-size:10px;" val="1">1号</li><li op="FontSize" style="font-size:12px;" val="2">2号</li><li op="FontSize" style="font-size:14px;" val="3">3号</li><li op="FontSize" style="font-size:16px;" val="4">4号</li><li op="FontSize" style="font-size:18px;" val="5">5号</li><li op="FontSize" style="font-size:20px;" val="6">6号</li><li op="FontSize" style="font-size:22px;" val="7">7号</li></ul>';l.append(o)},fn:function(l,o){o.children("ul").slideDown("fast").focus()}},fontName:{title:"字体",init:function(l){var o='<span class="tool" unselectable="on">字体</span><ul class="drop_down_box font_family_values" tabIndex="-1" onclick="$(this).blur()"><li op="FontName" val="宋体" style="font-family: \'宋体\';">宋体</li><li op="FontName" val="微软雅黑" style="font-family: \'微软雅黑\';">微软雅黑</li><li op="FontName" val="arial" style="font-family: \'arial\';">arial</li><li op="FontName" val="" style="font-family: \'arial black\';">arial black</li></ul>';l.append(o)},fn:function(l,o){o.children("ul").slideDown("fast").focus()}},foreColor:{title:"字体颜色",init:function(l){var o=$('<span class="tool" unselectable="on">字体颜色</span><ul class="drop_down_box font_color_values" tabIndex="-1" onclick="$(this).blur()"><li op="foreColor" style="background:#FFF;" val="#FFF"></li><li op="foreColor" style="background:#000;" val="#000"></li><li op="foreColor" style="background:#9c9;" val="#9c9"></li><li op="foreColor" style="background:#f90;" val="#f90"></li><li op="foreColor" style="background:#09c;" val="#09c"></li><li op="foreColor" style="background:#369;" val="#369"></li><li op="foreColor" style="background:#c03;" val="#c03"></li><li op="foreColor" style="background:#f60;" val="#f60"></li><li op="foreColor" style="background:#6c0;" val="#6c0"></li><li op="foreColor" style="background:#9c3;" val="#9c3"></li><li op="foreColor" style="background:#393;" val="#393"></li><li op="foreColor" style="background:#69c;" val="#69c"></li><li op="foreColor" style="background:#c69;" val="#c69"></li><li op="foreColor" style="background:#696;" val="#696"></li><li op="foreColor" style="background:#6cf;" val="#6cf"></li><li op="foreColor" style="background:#99f;" val="#99f"></li><li op="foreColor" style="background:#969;" val="#969"></li><li op="foreColor" style="background:#636;" val="#636"></li><li op="foreColor" style="background:#cc9;" val="#cc9"></li><li op="foreColor" style="background:#669;" val="#669"></li><li op="foreColor" style="background:#cc3;" val="#cc3"></li><li op="foreColor" style="background:#09c;" val="#09c"></li><li op="foreColor" style="background:#366;" val="#366"></li><li op="foreColor" style="background:#666;" val="#666"></li><li op="foreColor" style="background:#999;" val="#999"></li></ul>');l.append(o)},fn:function(l,o){o.children("ul").slideDown("fast").focus()}},insertImg:{title:"上传图片",init:function(l){var o=$('<div class="upload_dialog"><ul class="image_upload_area"><li><div class="img"><img src="../../imgs/01.jpg"/></div><div class="img_name" title="01.jpg">01.jpg</div></li></ul><div class="upload_tool"><button class="cancel_upload">取消</button><button class="do_upload">上传</button></div></div>'),t=o.children(".image_upload_area");t.on("dragenter",function(l){l.stopPropagation(),l.preventDefault(),t.addClass("drop")}).on("dragleave dragend drop",function(l){l.stopPropagation(),l.preventDefault(),t.removeClass("drop")}).on("dragover",function(l){l.stopPropagation(),l.preventDefault()}).on("drop",function(){var l,o,e,i=event.dataTransfer.files;$.each(i,function(i,a){o=a.type,o.indexOf("image")>-1&&(e=new FileReader,e.onload=function(){l='<li class="new"><div class="img"><img src="$url"/></div><div class="img_name" title="$name">$name</div></li>',l=$(l.replace("$url",this.result).replace("$name",a.name).replace("$name",a.name)).data("file",a),t.append(l)},e.readAsDataURL(a))})}),o.children(".upload_tool").children(".do_upload").click(function(){var l,o=t.find(".new"),e=new FormData;$.each(o,function(o,t){l=$(t).data("file"),e.append("imgs",l)});var i=new XMLHttpRequest;i.open("post","../../upload"),i.send(e)}),t.delegate("img","click",function(){excu("insertImage",!1,$(this).attr("src"))});var e=$().dialog({title:"<span style='font-family:微软雅黑;'>上传文件（把文件拖到虚线框内上传）</span>",content:o,beforeClose:function(){return!0}});l.data("dialog",e)},fn:function(l,o){o.data("dialog").show()}},createLink:{title:"创建链接",init:function(l){var o=$('<div class="drop_down_box" tabindex=-1><form class="link_argument"><span>链接地址：</span><input class="url" value="http://" autocomplated="off"/><br/><span>链接文字：</span><input class="txt" value="" autocomplated="off"/><br/><span>本页打开：</span><input name="tar" value="_blank" type="radio" checked autocomplated="off"/><br/><span>新页打开：</span><input name="tar" value="_parent" type="radio" autocomplated="off"/><br/></form><button class="done">确定</button><button class="cancel">取消</button></div>'),t=o.children(".link_argument");o.delegate("button","click",function(){if($(this).is(".done")){var l=t.children(".url").val(),o=t.children(".txt").val();l&&o&&insertHtml('<a href="url" target="$tar">txt</a>'.replace("url",l).replace("txt",o).replace("$tar",t.children("[name=tar]:checked").val()))}$(this).blur()}),l.append(o)},fn:function(l,o){o.children(".drop_down_box").slideDown("fast").focus().find(".link_argument>.txt").val(TXT)}},unlink:{title:"取消链接"}};