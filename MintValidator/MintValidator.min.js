!function(){var t=$("script").last().attr("src");$("head:first").append($('<link rel="stylesheet"/>').attr("href",t.replace(t.substring(t.lastIndexOf("/")+1),"css/style.css")))}();var MintValidator=function(t,i){var e=this;e.ajax=0,e.settings=$.extend(!0,{inputs:[],submitButton:"",rules:e.rules,onSubmit:$.noop,showTipsAfterInit:!1},i),$.extend(e.rules,i.rules),e.form=t,e.initContext(),e.result=!1,e.isBlocked=!1,e.isSubmit=!1,t.delegate("input,textarea","blur",function(){e.doValidate($(this))}).delegate("input,textarea","focus",function(){var t=$(this),i=t.data("setting");i&&e.tipStatu("focus",t,i.focusMsg)}),t.submit(function(){return e.isSubmit=e.result=!0,$.each(t.find("input,textarea"),function(t,i){e.result=e.doValidate($(i))&&e.result}),e.submit()}),e.settings.submitButton&&$(e.settings.submitButton).click(function(){e.isSubmit=e.result=!0,$.each(t.find("input,textarea"),function(t,i){e.result=e.doValidate($(i))&&e.result}),e.submit()})};MintValidator.prototype={rules:{},tipStatu:function(t,i,e){if(i.removeClass("status_focus status_right status_error").addClass("status_"+t),void 0==e)return void i.data("tip").hide();var s=i.position();s.top=s.top+parseInt(i.css("margin-top")),i.data("tip").removeClass("focus_tip right_tip error_tip ajax_check_tip").addClass(t+"_tip").html(e?e:"").css({display:"block",position:"absolute",top:s.top+Math.ceil((i.outerHeight()-32)/2),left:s.left+i.innerWidth()+12})},checkReg:function(t,i){var e=i.data("setting");return t.rule.test(i.val())?(this.tipStatu("right",i,e.rightMsg),!0):(this.tipStatu("error",i,t.tip),!1)},ajaxCheck:function(t,i){function e(){s.ajax-=1,0==s.ajax&&(s.isBlocked=!1,s.isSubmit&&s.submit())}var s=this,a=t.ajax;s.isBlocked=!0,s.ajax+=1,$.ajax({url:a.url,data:i.attr("name")+"="+i.val(),dataType:a.dataType?a.dataType:null,type:a.type?a.type:"get",beforeSend:function(){s.tipStatu("ajax_check",i,"验证中...")},success:function(t){var t=a.filter(t);t.result?(s.tipStatu("right",i,t.msg),s.result=s.result&&!0):(s.tipStatu("error",i,t.msg),s.result=s.result&&!1),s.result=s.result&&t.result,e()},error:function(){s.tipStatu("error",i,"网络出错"),s.result=s.result&&!1,e()}})},initContext:function(){var t,i,e=this,s=e.form,a=e.settings;$.each(a.inputs,function(r,u){i=s.find('[name="'+u.name+'"]'),0!=i.length&&(t=$("<span class='mint_validator input_tip'></span>"),i.data("tip",t).data("setting",u).after(t),a.showTipsAfterInit&&u.focusMsg&&e.tipStatu("focus",i,u.focusMsg))})},doValidate:function(t){var i=this,e=i.form,s=t.data("setting"),a=!0,r=i.settings.rules;return s&&s.rules&&($.each(s.rules,function(u,n){if(!r[n]||!a)return!1;var o=r[n];if("regexp"==$.type(o.rule))a=i.checkReg(o,t)&&a;else if("function"==$.type(o.rule)){var l={};$.each(e.serializeArray(),function(t,i){l[i.name]=i.value}),a=o.rule(t.val(),l)&&a,a?i.tipStatu("right",t,s.rightMsg):i.tipStatu("error",t,o.tip)}}),a&&s.ajax&&i.ajaxCheck(s,t)),a},submit:function(){var t=this;return t.isBlocked?void 0:(t.isSubmit=!1,t.settings.onSubmit(t.result,t.form))}},$.fn.validateForm=function(t){return new MintValidator(this,t),this};